NEJ.define(["./proxy.js","base/util","base/klass","base/event","base/config","base/element","util/ajax/message"],function(e,t,r,n,s,a,i,_,o,u,d){var c,$={};return _._$$ProxyFrame=r._$klass(),c=_._$$ProxyFrame._$extend(e._$$ProxyAbstract),c.__init=function(){var e="NEJ-AJAX-DATA:",t=!1,r=function(t){var r=t.data;if(0==r.indexOf(e)){r=JSON.parse(r.replace(e,""));var n=$[r.key];n&&(delete $[r.key],r.result=decodeURIComponent(r.result||""),n.__onLoadRequest(r))}},s=function(){t||(t=!0,n._$addEvent(window,"message",r))};return function(){this.__super(),s()}}(),c.__doSendRequest=function(e){var r=e.request,_=s._$getFrameProxy(r.url),o=$[_];if(t._$isArray(o))return void o.push(this.__doSendRequest._$bind(this,e));if(!o)return $[_]=[this.__doSendRequest._$bind(this,e)],void a._$createXFrame({src:_,visible:!1,onload:function(e){var r=$[_];$[_]=n._$getElement(e).contentWindow,t._$reverseEach(r,function(e){try{e()}catch(e){}})}});this.__rkey=t._$uniqueID(),$[this.__rkey]=this;var u=t._$fetch({url:"",data:null,timeout:0,method:"GET"},r);u.key=this.__rkey,u.headers=e.headers,i._$postMessage($[_],{data:u})},c._$abort=function(){delete $[this.__rkey],this.__onAbort()},_});