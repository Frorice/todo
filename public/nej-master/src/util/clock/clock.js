NEJ.define(["base/global","base/klass","base/element","base/event","base/util","util/event"],function(t,_,e,i,s,n,h,o,u,a){var r;return h._$$Clock=_._$klass(),r=h._$$Clock._$extend(n._$$EventTarget),r.__reset=function(t){this.__super(t),this.__hnode=e._$get(t.hour),this.__mnode=e._$get(t.minute),this.__snode=e._$get(t.second),this.__pnode=e._$get(t.per),this.__cnxt=e._$get(t.cnxt),this.__cprv=e._$get(t.cprv),this.__doInitDomEvent([[this.__cnxt,"click",this.__onTimeChange._$bind(this,-1)],[this.__cprv,"click",this.__onTimeChange._$bind(this,1)],[this.__hnode,"input",this.__onInput._$bind(this,0)],[this.__mnode,"input",this.__onInput._$bind(this,1)],[this.__snode,"input",this.__onInput._$bind(this,2)],[this.__hnode,"click",this.__onSelect._$bind(this)],[this.__mnode,"click",this.__onSelect._$bind(this)],[this.__snode,"click",this.__onSelect._$bind(this)]]),this.__flag=this.__hnode,this.__temp=[this.__hnode.value,this.__mnode.value,this.__snode.value],this._$setClock(t.date||new Date),this._$setFormat(t.format)},r.__destroy=function(){this.__super()},r.__doSyncTimeShow=function(){12==this.__format?this.__hour>11&&(this.__hour>21?this.__hnode.value=this.__hour-12:this.__hnode.value="0"+(this.__hour-12),this.__pnode.value="P.M."):this.__hnode.value=this.__hour,this.__mnode.value=this.__minute,this.__snode.value=this.__second},r.__onSelect=function(t){var _=i._$getElement(t);this.__flag=_,_.select()},r.__onInput=function(){var t=[23,59,59],_=/^\d{1,2}$/;return function(e,s){var n=i._$getElement(s),h=this.__temp[e],o=""+n.value,u=!_.test(o),a=""===o;a||((parseInt(n.value,10)>t[e]||u)&&(n.value=h),0==e&&12==this.__format&&(parseInt(n.value,10)>11||u)&&(n.value=h)),this.__temp[e]=n.value}}(),r.__onTimeChange=function(t,_){var e=this.__flag,i=this.__format,s=0;e.value?s=parseInt(e.value,10)+t:e.value=0,s<10&&s>-1?e.value="0"+s:e.value=s,"z-hour"==e.id?(s==i?e.value="00":s==-1&&(e.value=""+(i-1)),this.__hour=e.value,this.__temp[0]=""):"z-minute"!=e.id&&"z-second"!=e.id||(60==s?e.value="00":s==-1&&(e.value="59"),"z-minute"==e.id&&(this.__minute=e.value,this.__temp[1]=""),"z-second"==e.id&&(this.__second=e.value,this.__temp[2]=""))},r._$setClock=function(){var t=function(t,_){return _.h=t.getHours(),_.m=t.getMinutes(),_.s=t.getSeconds(),_},_=function(_){var e=_,i={};if(s._$isString(_)){var n=_.split(":");i.h=n[0],i.m=n[1],i.s=n[2]}return s._$isDate(_)?i=t(e,i):(e=new Date(_),i=t(e,i)),i};return function(t){t=_(t),this.__hour=t.h<10?"0"+t.h:t.h,this.__minute=t.m<10?"0"+t.m:t.m,this.__second=t.s<10?"0"+t.s:t.s,this.__doSyncTimeShow()}}(),r._$getClock=function(){var t={h:parseInt(this.__hour,10),m:parseInt(this.__minute,10),s:parseInt(this.__second,10)};return s._$forEach(this.__temp,function(_,e){_&&(0==e?t.h=_:1==e?t.m=_:t.s=_)}),12==this.__format&&(t.p=this.__pnode.value,"A.M."==t.p&&t.h>11?t.h-=12:"P.M."==t.p&&t.h<12&&(t.h+=12)),s._$forIn(t,function(_,e){parseInt(_,10)<10&&(t[e]="0"+parseInt(_,10))}),t},r._$setFormat=function(t){this.__format=t&&12==t?12:24,12==this.__format&&(this.__pnode.style.display="block",this.__doSyncTimeShow())},CMPT&&t.copy(t.P("nej.ut"),h),h});