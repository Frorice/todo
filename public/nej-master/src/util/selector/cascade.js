NEJ.define(["base/klass","base/util","base/event","base/element","util/event"],function(t,e,_,i,s,n,a,h,o,l){return n._$$CascadeSelector=t._$klass(),l=n._$$CascadeSelector._$extend(s._$$EventTarget),l.__reset=function(){var t={id:"id",text:"name",list:"list"};return function(_){this.__super(_),this.__conf=e._$merge({},t,_.keys),this.__nselect=[],this.__noffset=[];var s=[],n=[];e._$forEach(_.select,function(t,e){var _=i._$get(t);this.__nselect.push(_),this.__noffset.push(_.options.length),n.push(i._$dataset(t,"value")),s.push([t,"change",this.__onChange._$bind(this,e)])},this),this.__doInitDomEvent(s),this.__doFormatData(_.data||o),this._$update(n)}}(),l.__destroy=function(){this.__super(),this.__conf=null,this.__data=null,this.__lock=null,this.__default=null,this.__nselect=null},l.__doFormatData=function(){var t=function(_,i,s,n){_[s+"-"+(n||"")]=i,e._$forEach(i,function(e){var i=e[this.__conf.list];i&&t.call(this,_,i,s+1,e[this.__conf.id])},this)};return function(e){this.__data={},t.call(this,this.__data,e,0)}}(),l.__doClearList=function(t){if(t){var _=this.__noffset[e._$indexOf(this.__nselect,t)];e._$reverseEach(t.options,function(e,i){return i<_||void t.remove(i)})}},l.__doRefreshList=function(t,_,i){t&&(this.__doClearList(t),e._$forEach(_,function(e){var _=new Option(e[this.__conf.text],e[this.__conf.id]);t.add(_),i&&i==_.value&&(_.selected=!0)},this))},l.__doEmitChangeEvent=function(){var t={},_=[];e._$forEach(this.__nselect,function(e){_.push(e.value),t[e.name||e.id]=e.value}),_=_.join("\n"),_!=this.__lock&&(this.__lock=_,this._$dispatchEvent("onchange",t))},l.__onChange=function(t){var e,_=t+1;if(t<0)e=this.__data["0-"];else{var s=this.__nselect[t];e=this.__data[_+"-"+s.value]}if(e&&e.length){var s=this.__nselect[_];s&&(i._$setStyle(s,"visibility","visible"),this.__doRefreshList(s,e,this.__default[_]),this.__default[_]=null,this.__onChange(_))}else for(var n,a,h=_,o=this.__nselect.length;h<o;h++)n=this.__nselect[h],this.__doClearList(n),a=this.__noffset[h],a||i._$setStyle(n,"visibility","hidden");this.__doEmitChangeEvent()},l._$update=function(t){this.__default=t||[],this.__onChange(-1)},n});