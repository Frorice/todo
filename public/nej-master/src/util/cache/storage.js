NEJ.define(["base/global","base/util","base/event","util/event/event","util/encode/json","{platform}storage.js"],function(t,e,n,a,o,r,i,_,u,g){var c={};return i._$init=function(){var t=!1;return function(){if(!t){t=!0;var a=function(){var t=function(t,e,n){r.__setItemToStorage(e,JSON.stringify(t)),delete n[e]};return function(){e._$loop(c,t)}}();n._$addEvent(document,"storageready",a),r.__initStorage()}}}(),i._$setDataInStorage=function(t,e){i._$init();var n=JSON.stringify(e);try{r.__setItemToStorage(t,n)}catch(t){console.error(t.message),console.error(t)}n!=r.__getItemInStorage(t)&&(c[t]=e)},i._$getDataInStorage=function(t){i._$init();var e=JSON.parse(r.__getItemInStorage(t)||"null");return null==e?c[t]:e},i._$getDataInStorageWithDefault=function(t,e){var n=i._$getDataInStorage(t);return null==n&&(n=e,i._$setDataInStorage(t,n)),n},i._$delDataInStorage=function(t){i._$init(),delete c[t],r.__removeItemFromStorage(t)},i._$clearDataInStorage=function(){var t=function(t,e,n){delete n[e]};return function(){i._$init(),e._$loop(c,t),r.__clearStorage()}}(),a._$$CustomEvent._$allocate({element:document,event:"storageready",oneventadd:function(){r.__isStorageReady()&&n._$dispatchEvent(document,"storageready")}}),CMPT&&t.copy(t.P("nej.j"),i),i});