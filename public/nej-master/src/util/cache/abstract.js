NEJ.define(["base/global","base/klass","base/util","base/event","util/ajax/xdr","util/ajax/rest","util/ajax/jsonp","./list.js"],function(t,i,e,o,n,r,s,l,_,a,d,u,c){var $={},h=e._$uniqueID(),f=function(t,i){i=i||{},e._$forEach($[t+"-"+h],function(t){if(t.call(this,i),i.stopped)return!0},this)};return _._$$CacheListAbstract=i._$klass(),c=_._$$CacheListAbstract._$extend(l._$$CacheList),c.__doSendRequest=function(t,i){var o=$[t];if(!o)return void console.error("not found request config for "+t);var l=function(t){var n={req:i,error:t||{}};if(f.call(this,"error",n),!n.stopped){var r=i.onerror||o.onerror||"onerror";e._$isFunction(r)?r.call(this,n):e._$isString(r)&&this._$dispatchEvent(r,n)}},_=function(t){var n={req:i,res:t};if(e._$isFunction(o.post)&&o.post.call(this,n),f.call(this,"post",n),n.error)return void l.call(this,n.error);e._$isFunction(o.format)&&o.format.call(this,n),f.call(this,"format",n);var r=i.onload||o.onload;null!=n.result&&(t=n.result),e._$isFunction(r)?r.call(this,t):e._$isString(r)&&this._$dispatchEvent(r,t),e._$isFunction(o.finaly)&&o.finaly.call(this,n)},a={url:o.url,req:i};f.call(this,"filter",a),e._$isFunction(o.filter)&&o.filter.call(this,a);var d=e._$merge({},i,{type:o.type||"json",method:o.method||"POST",onload:_._$bind(this),onerror:l._$bind(this)}),u=n;o.rest&&(u=r),o.jsonp&&(u=s),u._$request(a.url,d)},c.__reset=function(t){this.__super(t),this._$batEvent({doloadlist:this.__doLoadList._$bind(this),doloaditem:this.__doLoadItem._$bind(this),doadditem:this.__doAddItem._$bind(this),dodeleteitem:this.__doDeleteItem._$bind(this),doupdateitem:this.__doUpdateItem._$bind(this),dopullrefresh:this.__doPullRefresh._$bind(this)})},c.__doLoadList=d,c.__doPullRefresh=d,c.__doLoadItem=d,c.__doAddItem=d,c.__doDeleteItem=d,c.__doUpdateItem=d,_._$on=function(){var t=function(t,i){if(e._$isFunction(i)){var o=t+"-"+h,n=$[o]||[];n.push(i),$[o]=n}};return function(i){return e._$isString(i)?void t.apply(null,arguments):void e._$loop(i,function(i,e){t(e,i)})}}(),_._$do=function(t,i){if(e._$isFunction(i)){var o=t._$allocate(),n=i.call(null,o);return o._$recycle(),n}},_._$config=function(t){e._$forIn(t,function(t,i){"string"==typeof t&&(t={url:t}),$[i]=t})},_._$merge=function(t,i){var o=$[t];o?$[t]=e._$merge(o,i):$[t]=i},_._$dump=function(){return $},CMPT&&(t.P("nej.ut")._$$AbstractListCache=_._$$CacheListAbstract),_});