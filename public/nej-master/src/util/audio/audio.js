NEJ.define(["base/global","base/util","{platform}audio.js"],function(n,t,o,i,a,e,u){if(i._$audio=function(n){return o.__getAudioInst(n)},i._$play=function(){var n={},a=function(t,o,i,a){var u=n[t];if(u){var r=u.conf,d=r[o]||e,c=r.extra;a&&delete n[t],i.data=c,d(i)}},u=function(n,t){a(n,"onstatechange",{state:t},0==t)},r=function(n,t){a(n,"onerror",{code:t},!0)},d=function(n,t){a(n,"ontimeupdate",t)},c=function(n,t){0==t.state&&f(n),u(n,t.state)},l=function(t){var i=n[t];i&&(i.audio=o.__getAudioInst({url:i.url,onerror:_._$bind(null,t),ontimeupdate:d._$bind(null,t),onstatechange:c._$bind(null,t)}),i.audio._$play())},f=function(t){var o=n[t];o&&(o.audio&&(o.audio=o.audio._$recycle()),o.timer&&(o.timer=window.clearTimeout(o.timer)))},_=function(t,o){var i=n[t];if(i){f(t);var a=i.conf;a.retry>0?(a.retry--,i.timer=window.setTimeout(l._$bind(null,t),a.interval||500)):r(t,o.code)}};return i._$stop=function(t){var o=n[t||"auto-audio"];o&&o.audio._$stop()},function(o,i){if(o){var a=t._$merge({},i),e=a.key||"auto-audio",r=n[e];r&&(f(e),u(e,0)),n[e]={url:o,conf:a},l(e)}}}(),CMPT){var r=n.P("nej.e");r._$audio=i._$audio,r._$playBgSound=i._$play,r._$stopBgSound=i._$stop}return i});