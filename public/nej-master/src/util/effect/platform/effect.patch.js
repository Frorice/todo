NEJ.define(["./effect.js","base/element"],function(t,e,n,i,a,o){return NEJ.patch("GV",function(){t.__onStart=function(t,n,i){return i=i.slice(0,-1),e._$setStyle(t,"transition",i),setTimeout(function(){e._$style(t,n)},33),this}}),NEJ.patch("TR<=5.0",["base/util","util/animation/linear","util/animation/easein","util/animation/easeout","util/animation/easeinout"],function(n,i,a,o,r){var s={linear:i._$$AnimLinear,"ease-in":a._$$AnimEaseIn,"ease-out":o._$$AnimEaseOut,"ease-in-out":r._$$AnimEaseInOut};t.__onStart=function(){var i=function(t,e){var i="";return n._$forIn(t,function(t,n){i+=e.replace("all",n)}),i},a=function(t,e){return"filter"===e&&(t=n._$fixed(t,0),t="alpha(opacity="+t+")"),"z-index"===e&&(t=n._$fixed(t,0)),t},o=function(t){return s[t.split(" ")[2]]},r=function(n,i,o,r,f){var i=i.split(" "),_=i[0],c=parseFloat(e._$getStyle(n,_))||0,u=parseFloat(o[_])||0,l=s[i[2]],p=1e3*i[3].slice(0,-1)||0,m=1e3*i[1].slice(0,-1)||0,$=1e3*i[1].slice(0,-1)+1e3*i[3].slice(0,-1);$>=n.sumTime&&(n.sumTime=$,n.isLastOne=f),"opacity"===_&&(_=t.__formatOpacity?t.__formatOpacity():_,c=t.__formatFrom?t.__formatFrom(n):c,u=t.__formatTo?t.__formatTo(u):u);var y={delay:p,from:{offset:c},to:{offset:u},duration:m,onupdate:function(i){var o=i.offset;t.__doCheckProp(_)?e._$setStyle(n,_,o+"px"):(o=a(o,_),e._$setStyle(n,_,o))},onstop:function(t,e){e=e||[];var i=n.effects[f];i&&(i=l._$recycle(i),n.effects[f]=i,n.isLastOne===f&&r.apply(this,e))}._$bind(this,f)};return y};return t.__onStart._$aop(function(t){t.stopped=!0;var e=t.args,a=e[0],s=e[1],f=e[2],_=e[3];a.isStop=!1,a.sumTime=0,a.isLastOne=0;var c=[];f.indexOf("all")>-1&&(f=i(s,f));var u=f.slice(0,-1);return u=u.split(","),a.effects=[],n._$forEach(u,function(t,e){var n=r(a,t,s,_,e);c.push({o:n,c:o(t)})}),n._$forEach(c,function(t,e){var n=t.c._$allocate(t.o);a.effects[e]=n,n._$play()}),this})}(),t.__onStop=t.__onStop._$aop(function(t){t.stopped=!0;var e=t.args,i=e[0];return n._$forEach(i.effects,function(t){i.isStop=!0,t&&t._$stop(e[1],e[3]||!1)}),this})}),NEJ.patch("TR<=4.0",function(){t.__formatOpacity=function(t){return"filter"},t.__formatFrom=function(t){var n=e._$getStyle(t,"filter"),i=parseFloat(n.split("=")[1])||0;return i},t.__formatTo=function(t){return 100*t}}),t});