NEJ.define(["base/global","base/klass","{platform}effect.js","base/element","base/util","util/event"],function(t,_,i,s,n,e,o,r,a,h){var p;return o._$$Effect=_._$klass(),p=o._$$Effect._$extend(e._$$EventTarget),p.__reset=function(t){this.__super(t),this.__node=s._$get(t.node),this.__styles=t.styles||[],this.__onstop=t.onstop||a,this.__transition=t.transition||[],this.__propMap={},this.__animRule=this.__doParseStyle(),this.__doInitDomEvent([[this.__node,"transitionend",this.__onTransitionEnd._$bind(this)]])},p.__destroy=function(){this.__intvl&&(this.__intvl=window.clearInterval(this.__intvl)),delete this.__node,delete this.__styles,delete this.__animRule,delete this.__propMap,delete this.__lastProp,delete this.__transition,delete this.__intvl,this.__super()},p.__onTransitionEnd=function(t){this.__start&&this.__isLast(t)&&(this.__start=!1,this._$stop())},p.__isLast=function(t){var _=t.propertyName,i=!1;return n._$forIn(this.__lastProp,function(t){i=_.indexOf(t)>-1}._$bind(this)),!(!i&&!this.__lastProp[_])},p.__doParseStyle=function(){var t=function(t){var _=t.split(":"),n=_[0],e=_[1],o=this.__node;if(e.indexOf("=")>-1){var r=parseInt(s._$getStyle(o,n))||0,a=parseInt(e.split("=")[1]);e=e.indexOf("+")>-1?r+a:r-a}i.__doCheckProp(n)&&e.toString().indexOf("px")<0&&(e+="px"),this.__propMap[n]=e},_=function(t){if(!this.__transition[t])return"";var _=this.__transition[t],i=_.duration+_.delay;return i>this.__sumtime?(this.__lastProp={},this.__sumtime=i,this.__lastProp[_.property]=_.property):i==this.__sumtime&&(this.__lastProp[_.property]=_.property),_.property+" "+_.duration+"s "+_.timing+" "+_.delay+"s,"};return function(){var i="";return this.__sumtime=0,this.__lastProp={},n._$forEach(this.__styles,function(s,n){t.call(this,s),i+=_.call(this,n)}._$bind(this)),i}}(),p.__onPlayState=function(){this.__state={},n._$forIn(this.__propMap,function(t,_){this.__state[_]=s._$getStyle(this.__node,_)}._$bind(this)),this._$dispatchEvent("onplaystate",this.__state)},p._$start=function(){this.__start=!0,i.__onStart(this.__node,this.__propMap,this.__animRule,this.__onstop),this.__intvl=window.setInterval(this.__onPlayState._$bind(this),49)},p._$stop=function(t){this.__intvl=window.clearInterval(this.__intvl),i.__onStop(this.__node,this.__propMap,this.__onstop,t)},p._$paused=function(){},p._$restart=function(){},CMPT&&t.copy(t.P("nej.ut"),o),o});