NEJ.define(["base/global","base/klass","base/event","base/util"],function(t,e,n,_,i,s,o,r){var c;return i._$$EventTarget=e._$klass(),c=i._$$EventTarget.prototype,i._$$EventTarget._$allocate=function(t){t=t||{};var e=!!this.__pool&&this.__pool.shift();return e||(e=new this(t),this.__inst__=(this.__inst__||0)+1),e.__reset(t),e},i._$$EventTarget._$recycle=function(){var t=function(t,e,n){t._$recycle(),n.splice(e,1)};return function(e){if(!e)return null;if(!_._$isArray(e)){if(!(e instanceof this)){var n=e.constructor;return n._$recycle&&n._$recycle(e),null}return e==this.__instance&&delete this.__instance,e==this.__inctanse&&delete this.__inctanse,e.__destroy(),this.__pool||(this.__pool=[]),_._$indexOf(this.__pool,e)<0&&this.__pool.push(e),null}_._$reverseEach(e,t,this)}}(),i._$$EventTarget._$getInstance=function(t){return this.__instance||(this.__instance=this._$allocate(t)),this.__instance},i._$$EventTarget._$getInstanceWithReset=function(t,e){return e&&this.__inctanse&&(this.__inctanse._$recycle(),delete this.__inctanse),this.__inctanse?this.__inctanse.__reset(t):this.__inctanse=this._$allocate(t),this.__inctanse},c.__init=function(){this.__events={},this.__events_dom={},this.id=_._$uniqueID()},c.__reset=function(t){this._$batEvent(t)},c.__destroy=function(){this._$clearEvent(),this.__doClearDomEvent()},c.__doInitDomEvent=function(){var t=function(t){!t||t.length<3||(this.__events_dom["de-"+_._$uniqueID()]=t,n._$addEvent.apply(n,t))};return function(e){_._$forEach(e,t,this)}}(),c.__doClearDomEvent=function(){var t=function(t,e,_){delete _[e],n._$delEvent.apply(n,t)};return function(){_._$loop(this.__events_dom,t)}}(),c.__doClearComponent=function(t){t=t||o,_._$loop(this,function(e,n,_){e&&e._$recycle&&!t(e)&&(delete _[n],e._$recycle())})},c._$recycle=function(){this.constructor._$recycle(this)},c._$hasEvent=function(t){var t=(t||"").toLowerCase(),e=this.__events[t];return!!e&&e!==o},c._$delEvent=function(t,e){var t=(t||"").toLowerCase(),n=this.__events[t];return _._$isArray(n)?(_._$reverseEach(n,function(t,n,_){t==e&&_.splice(n,1)}),void(n.length||delete this.__events[t])):void(n==e&&delete this.__events[t])},c._$setEvent=function(t,e){t&&_._$isFunction(e)&&(this.__events[t.toLowerCase()]=e)},c._$batEvent=function(){var t=function(t,e){this._$setEvent(e,t)};return function(e){_._$loop(e,t,this)}}(),c._$clearEvent=function(){var t=function(t,e){this._$clearEvent(e)};return function(e){var e=(e||"").toLowerCase();e?delete this.__events[e]:_._$loop(this.__events,t,this)}}(),c._$addEvent=function(t,e){if(t&&_._$isFunction(e)){t=t.toLowerCase();var n=this.__events[t];if(!n)return void(this.__events[t]=e);_._$isArray(n)||(this.__events[t]=[n]),this.__events[t].push(e)}},c._$dispatchEvent=function(t){var t=(t||"").toLowerCase(),e=this.__events[t];if(e){var n=r.slice.call(arguments,1);return _._$isArray(e)?void _._$forEach(e,function(t){if(DEBUG)t.apply(this,n);else try{t.apply(this,n)}catch(t){console.error(t.message),console.error(t.stack)}},this):void e.apply(this,n)}},CMPT&&(i._$$Event=i._$$EventTarget,t.copy(t.P("nej.ut"),i)),i});