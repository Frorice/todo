NEJ.define(["base/global","base/klass","base/config","util/flash/flash","./media.js"],function(_,t,i,n,o,e,s,a,h){var u;return e._$$MediaFlash=t._$klass(),u=e._$$MediaFlash._$extend(o._$$Media),u.__init=function(){var _=function(_){this.__audio=_,this.__action&&(this.__action.call(this),delete this.__action)};return function(){this.__super(),n._$flash({hidden:!0,src:i._$get("audio.swf"),onready:_._$bind(this),onended:this.__onStop._$bind(this),onpause:this.__onPause._$bind(this),onseeking:this.__onLoading._$bind(this),onprogress:this.__onLoading._$bind(this),ontimeupdate:this.__onPlaying._$bind(this),onvolumechange:this.__onVolumeChange._$bind(this),onerror:this.__onError._$bind(this)})}}(),u.__destroy=function(){this.__super(),delete this.__action},u.__doPlay=function(){this.__audio?(this.__source&&(this.__audio.nej_setSrc(this.__source),delete this.__source),this.__audio.nej_play()):this.__action=this.__doPlay},u.__doPause=function(){this.__audio?this.__audio.nej_pause():this.__action=this.__doPause},u.__doStop=function(){this.__audio?(this.__audio.nej_stop(),this.__doStateChange(0)):this.__action=this.__doStop},u.__onLoading=function(){this.__doStateChange(1)},u.__onPause=function(){this.__doStateChange(3)},u.__onPlaying=function(_){if(this.__doStateChange(2),this._$dispatchEvent("ontimeupdate",{duration:_.duration,current:_.currentTime}),null!=this.__dtvol){var t=this.__dtvol;delete this.__dtvol,this.__setVolume(t)}},u.__onError=function(_){this.__doError(),this._$dispatchEvent("onerror",{code:_.code})},u.__setCurrentTime=function(_){1!=this.__state&&this.__audio.nej_seek(_||0)},u.__getCurrentTime=function(){return this.__audio.nej_flash_get_currentTime()},u.__setVolume=function(_){if(!this.__audio)return void(this.__dtvol=_);try{this.__audio.nej_flash_set_volume(_)}catch(t){this.__dtvol=_}},u.__getVolume=function(){if(this.__audio)return this.__audio.nej_flash_get_volume()},u._$duration=function(){return this.__audio?this.__audio.nej_flash_get_duration():0},CMPT&&_.copy(_.P("nej.ut"),e),e});