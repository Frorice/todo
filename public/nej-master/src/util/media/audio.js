NEJ.define(["base/global","base/klass","./media.js"],function(_,i,t,o,s,e,u){var n;return o._$$MediaAudio=i._$klass(),n=o._$$MediaAudio._$extend(t._$$Media),n.__reset=function(_){this.__audio=new Audio,this.__doInitDomEvent([[this.__audio,"loadstart",this.__onLoading._$bind(this)],[this.__audio,"timeupdate",this.__onPlaying._$bind(this)],[this.__audio,"pause",this.__onPause._$bind(this)],[this.__audio,"volumechange",this.__onVolumeChange._$bind(this)],[this.__audio,"ended",this.__onStop._$bind(this)],[this.__audio,"error",this.__onError._$bind(this)]]),this.__super(_)},n.__destroy=function(){this.__super(),delete this.__audio},n.__doPlay=function(){this.__audio.src!=this.__source&&(this.__audio.src=this.__source,this.__source=this.__audio.src),this.__audio.play()},n.__doPause=function(){this.__audio.pause()},n.__doStop=function(){this.__stopped=!0,this.__doPause(),3==this.__state&&this.__onPause()},n.__onLoading=function(){this.__audio.paused||this.__doStateChange(1)},n.__onPause=function(){var _=this.__stopped?0:3;if(this.__stopped=!1,this.__doStateChange(_),0==_)try{this.__audio.removeAttribute("src")}catch(_){}},n.__onPlaying=function(){var _=this.__audio.duration;this.__audio.paused||isNaN(_)||(this.__doStateChange(2),this._$dispatchEvent("ontimeupdate",{duration:this.__audio.duration,current:this.__audio.currentTime}))},n.__onError=function(_){this.__doError();var i=this.__audio.error;this._$dispatchEvent("onerror",{code:i.code})},n.__setCurrentTime=function(_){1!=this.__state&&(this.__audio.currentTime=_||0)},n.__getCurrentTime=function(){return this.__audio.currentTime},n.__setVolume=function(_){this.__audio.volume=_},n.__getVolume=function(){return this.__audio.volume},n._$duration=function(){return this.__audio?this.__audio.duration:0},CMPT&&_.copy(_.P("nej.ut"),o),o});