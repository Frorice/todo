NEJ.define(["base/element","base/platform"],function(e,n,t,r,o,i){var c=/(?:<(p|div)>(?:\&nbsp\;|<br\/?>)<\/\1>|<br\/?>|\&nbsp\;|\s)+$/gi,a=/(?:class|lang)="(mso)?[^"]*"/gi,l=/(?:class|lang)='(mso)?[^']*'/gi,u=/(?:class|lang)=(mso)?[^>\s]*/gi,_=/(?:<!--)[^>]*(?:-->)/gi,s=/(?:background-color:|text-align:|color:)([^;]*)(;)*/gi;return t.__getWindow=function(e){var n=t.__getDocument(e);return n.defaultView||n.parentWindow||n.window||n},t.__getDocument=function(e){return e.ownerDocument||e},t.__getSelection=function(e){if(e.getSelection)return e.getSelection();var n=e.document;return n.getSelection?n.getSelection():n.selection?n.selection:null},t.__getRange=function(e){e=t.__getWindow(e);var n=t.__getSelection(e);return n?n.getRangeAt?n.getRangeAt(0):n.createRange?n.createRange():null:null},t.__getSelectText=function(e){var n=this.__getRange(e);return n?n.toString()||n.cloneContents().textContent||n.commonAncestorContainer.data:""},t.__getSelectHtml=function(n){var t=this.__getRange(n);if(!t)return"";var r=e._$create("div");return r.appendChild(t.cloneContents()),r.innerHTML},t.__getSelectNode=function(){var e=function(n){return 1==n.nodeType?n:(n=n.parentNode,e(n))};return function(n){var t=this.__getRange(n),r=t.commonAncestorContainer||t.parentElement();return t&&r?e(r):""}}(),t.__saveRange=function(e){},t.__focusRange=function(e){e.focus()},t.__clearRange=function(e){},t.__supportSelectionChange=function(e){},t.__moveCursorPosition=function(){var e=[function(e){return e.childNodes.length},function(){return 0}];return function(n,r){var o=e[r];o&&t.__getSelection(t.__getWindow(n)).collapse(n,o(n))}}(),t.__execCommand=function(e,n,t){return"inserthtml"==n?void this.__insertHtml(e,t):void e.execCommand(n,!1,t)},t.__insertHtml=function(e,n){if(!document.selection)return void e.execCommand("inserthtml",!1,n);var t=e.selection.createRange();return t.pasteHTML?void t.pasteHTML(n):(e.execCommand("delete",!1,null),void e.selection.createRange().pasteHTML(n))},t.__filterContent=function(e,n){var r;return r=n?(e||"").replace(c,"").replace(_,""):(e||"").replace(c,"").replace(a,"").replace(l,"").replace(u,"").replace(_,""),r=t.__filterContentPath?t.__filterContentPath(r):r},t.__filterContentStyle=function(){var e={0:/(?:<[^>]* style)="([^"]*)"/gi,1:/(?:<[^>]* style)='([^']*)'/gi,2:/(?:<[^>]* style)=([^>\s]*)/gi},n=function(n,t){return t=t.replace(e[n],function(e,n,t){var r=e.split("style")[0];if(null!=n.match(s)){var o="";n.replace(s,function(e,n,t){return o+=e}._$bind(this));return r+' style="'+o+'"'}return r}._$bind(this))};return function(e){return e=n(0,e),e=n(1,e),e=n(2,e)}}(),t});