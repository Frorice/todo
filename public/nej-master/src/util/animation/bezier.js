NEJ.define(["base/global","base/klass","base/util","./animation.js"],function(i,t,e,n,_,s,o,r){var a;return _._$$AnimBezier=t._$klass(),a=_._$$AnimBezier._$extend(n._$$Animation),a.__reset=function(i){this.__super(i),this.__duration=i.duration||200,this.__epsilon=1/(200*this.__duration),this.__doParseTiming(i.timing),this.__doCalPolynomialCoefficients()},a.__destroy=function(){this.__super(),delete this.__pointer,delete this.__coefficient},a.__doParseTiming=function(){var i=/^cubic\-bezier\((.*?)\)$/i,t=/\s*,\s*/i,n={linear:[0,0,1,1],ease:[.25,.1,.25,1],easein:[.42,0,1,1],easeout:[0,0,.58,1],easeinout:[0,0,.58,1]},_=function(i,t,e){e[t]=parseFloat(i)};return function(s){s=(s||"").toLowerCase(),this.__pointer=n[s],i.test(s)&&(this.__pointer=RegExp.$1.split(t),e._$forEach(this.__pointer,_)),this.__pointer||(this.__pointer=n.ease)}}(),a.__doCalPolynomialCoefficients=function(){var i=this.__pointer,t=3*i[0],e=3*(i[2]-i[0])-t,n=1-t-e,_=3*i[1],s=3*(i[3]-i[1])-_,o=1-_-s;this.__coefficient={ax:n,ay:o,bx:e,by:s,cx:t,cy:_}},a.__doCalCubicBezierAtTime=function(){var i=function(i,t){return((t.ax*i+t.bx)*i+t.cx)*i},t=function(i,t){return((t.ay*i+t.by)*i+t.cy)*i},e=function(i,t){return(3*t.ax*i+2*t.bx)*i+t.cx},n=function(t,n,_){var s,o,r,a,f,u;for(r=t,u=0;u<8;u++){if(a=i(r,_)-t,Math.abs(a)<n)return r;if(f=e(r,_),Math.abs(f)<1e-6)break;r-=a/f}if(s=0,o=1,r=t,r<s)return s;if(r>o)return o;for(;s<o;){if(a=i(r,_),Math.abs(a-t)<n)return r;t>a?s=r:o=r,r=.5*(o-s)+s}return r};return function(i){return t(n(i/this.__duration,this.__epsilon,this.__coefficient),this.__coefficient)}}(),a.__doAnimationFrame=function(i){var t=i-this.__begin.time,n=this.__doCalCubicBezierAtTime(t),_=e._$fixed(this.__begin.offset*(1-n)+this.__end.offset*n,2),s=!1;return t>=this.__duration&&(_=this.__end.offset,s=!0),this._$dispatchEvent("onupdate",{offset:1*_}),s},a._$stop=function(){this._$dispatchEvent("onupdate",{offset:this.__end.offset}),this.__super()},CMPT&&i.copy(i.P("nej.ut"),_),_});