NEJ.define(["base/global","base/klass","base/element","base/event","base/util","util/event"],function(t,e,_,n,s,i,a,h,o,d){var r;return a._$$Calendar=e._$klass(),r=a._$$Calendar._$extend(i._$$EventTarget),r.__reset=function(t){this.__super(t),this.__doInitDomEvent([[t.mprv,"click",this.__onMonthChange._$bind(this,-1)],[t.mnxt,"click",this.__onMonthChange._$bind(this,1)],[t.yprv,"click",this.__onYearChange._$bind(this,-1)],[t.ynxt,"click",this.__onYearChange._$bind(this,1)],[t.wprv,"click",this.__onWeekChange._$bind(this,-1)],[t.wnxt,"click",this.__onWeekChange._$bind(this,1)],[t.wprv,"click",this.__onDayChange._$bind(this,-1)],[t.wnxt,"click",this.__onDayChange._$bind(this,1)]]),this.__offset=t.offset||0,this.__nyear=_._$get(t.year),this.__nmonth=_._$get(t.month),this.__selected=t.selected||"js-selected",this.__extended=t.extended||"js-extended",this.__disabled=t.disabled||"js-disabled",this.__doRangeCheck(t.range),this.__doDateListCheck(t.list),this._$setDate(t.date||new Date)},r.__destroy=function(){this.__super(),delete this.__list,delete this.__range,delete this.__nyear,delete this.__nmonth},r.__doRangeCheck=function(t){this.__range=t||[];var e=this.__range[0];this.__range[0]=s._$isDate(e)?+e:e||0;var e=this.__range[1];this.__range[1]=s._$isDate(e)?+e:e||0},r.__doDateListCheck=function(){var t=function(t){this.__list.push(t),this.__doInitDomEvent([[t,"click",this.__onDateChange._$bind(this)]])};return function(e){this.__list=[],s._$forEach(e,t,this)}}(),r.__doSaveDateInfo=function(){var t=function(t,e){var _=t[0],n=t[1];return e<_||!!n&&e>n};return function(e,n,s,i){_._$dataset(e,"y",n),_._$dataset(e,"m",s),_._$dataset(e,"d",i),e.innerText=i,e.title=n+"年"+s+"月"+i+"日",n==this.__year&&s==this.__month&&i==this.__date?_._$addClassName(e,this.__selected):_._$delClassName(e,this.__selected),t(this.__range,+new Date(n,s-1,i))?_._$addClassName(e,this.__disabled):_._$delClassName(e,this.__disabled)}}(),r.__doSyncDateShow=function(){var t=[31,28,31,30,31,30,31,31,30,31,30,31],e=function(t){return!(t%400&&(t%4||!(t%100)))},n=function(_,n){return 2==n&&e(_)?29:t[n-1]};return function(){var t=this.__year,e=this.__month,s=new Date(t,e-1,1),i=(7+s.getDay()-this.__offset)%7,a=Math.min(this.__list.length,i+n(t,e));this.__nyear&&(this.__nyear.innerText=this.__year),this.__nmonth&&(this.__nmonth.innerText=this.__month);for(var h,o=i;o<a;o++)h=this.__list[o],this.__doSaveDateInfo(h,t,e,o-i+1),_._$delClassName(h,this.__extended);if(i>0)for(var h,s=new Date(t,e-2||0,1),d=s.getFullYear(),r=s.getMonth()+1,l=n(d,r),o=i-1;o>=0;o--)h=this.__list[o],this.__doSaveDateInfo(h,d,r,l--),_._$addClassName(h,this.__extended);var c=this.__list.length;if(a<c-1)for(var s=new Date(t,e,1),d=s.getFullYear(),r=s.getMonth()+1,o=a,$=1;o<c;o++)h=this.__list[o],this.__doSaveDateInfo(h,d,r,$++),_._$addClassName(h,this.__extended)}}(),r.__onYearChange=function(t){this.__year+=t,this.__doSyncDateShow(),this._$dispatchEvent("onchange",this._$getDate())},r.__onMonthChange=function(t){this.__month+=t,this.__month<1&&(this.__year--,this.__month+=12),this.__month>12&&(this.__year+=Math.floor(this.__month/12),this.__month=(this.__month-1)%12+1),this.__doSyncDateShow(),this._$dispatchEvent("onchange",this._$getDate())},r.__onDateChange=function(t){var e=n._$getElement(t);_._$hasClassName(e,this.__disabled)||(this.__year=parseInt(_._$dataset(e,"y")),this.__month=parseInt(_._$dataset(e,"m")),this.__date=parseInt(_._$dataset(e,"d")),this.__doSyncDateShow(),this._$dispatchEvent("onselect",this._$getDate()))},r.__onWeekChange=function(t){},r.__onDayChange=function(t){},r._$setDate=function(t){t=s._$var2date(t),this.__year=t.getFullYear(),this.__month=t.getMonth()+1,this.__date=t.getDate(),this.__doSyncDateShow()},r._$getDate=function(){return new Date(this.__year,this.__month-1,this.__date)},CMPT&&t.copy(t.P("nej.ut"),a),a});