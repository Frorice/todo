NEJ.define(["base/global","base/element","base/event","base/util","util/template/jst","util/timer/animation","{platform}flash.js","text!./flash.html"],function(e,t,n,a,i,o,r,d,u,c,l,s){var f=i._$add(d);return u._$flash=function(){var d,u={},c=/^(?:mouse.*|(?:dbl)?click)$/i;window.onflashevent=function(e){var t=decodeURIComponent(e.target),n=e.type.toLowerCase(),a=u[t+"-tgt"];a&&c.test(n)&&s(a,e);var i=u[t+"-on"+n];if(i){var o="";try{o=i(e)}catch(e){}return o}};var l=function(e){d=document.title;var n=t._$get(e.parent)||document.body,a=i._$get(f,e);n.insertAdjacentHTML(e.hidden?"afterBegin":"beforeEnd",a)},s=function(e,t){var a=t.type.toLowerCase();o.requestAnimationFrame(function(){n._$dispatchEvent(e,a)})},v=function(e){return!!e&&!!e.inited&&!!e.inited()},m=function(e){var n=[document.embeds[e],t._$get(e),document[e],window[e]],i=a._$forIn(n,v),o=n[i],r=e+"-count";return u[r]++,o||u[r]>100?(d&&(document.title=d,d=null),u[e](o),delete u[e],void delete u[r]):void window.setTimeout(m._$bind(null,e),300)},_=function(e){var n=e.id,i=e.params;i||(i={},e.params=i);var o=i.flashvars||"";if(o+=(o?"&":"")+("id="+n),!e.hidden&&(e.target||r.__canFlashEventBubble(i.wmode))){var d=t._$id(e.target)||t._$id(e.parent);u[n+"-tgt"]=d}i.flashvars=o,a._$loop(e,function(e,t){a._$isFunction(e)&&"onready"!=t&&(u[n+"-"+t]=e)})};return function(t){if(t=e.X({},t),t.src){var n="_"+a._$uniqueID();t.id=n,_(t),l(t),t.onready&&(u[n]=t.onready,u[n+"-count"]=0,m(n))}}}(),CMPT&&e.copy(e.P("nej.e"),u),u});