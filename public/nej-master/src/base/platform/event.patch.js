NEJ.define(["./event.js","base/util"],function(e,n,t,a,o,r){return NEJ.patch("TR>=6.0",function(){e.__checkEvent=function(){var n={touchcancel:"MSPointerCancel",touchstart:"MSPointerDown",touchmove:"MSPointerMove",touchend:"MSPointerUp",fullscreenchange:"MSFullscreenChange"};return e.__checkEvent._$aop(function(e){var t=e.args,a=n[t[1]];a&&(e.stopped=!0,e.value={type:a,handler:t[2]})})}()}),NEJ.patch("TR==5.0",function(){e.__checkEvent=function(){var n={},t={input:function(e,t,a){return a?{type:t,handler:function(t){var o=e.id;n[o]=e.value,a.call(e,t)},link:[[document,"selectionchange",function(t){var o=e.id;return e!=document.activeElement?void delete n[o]:void(n[o]!==e.value&&(n[o]=e.value,a.call(e,t)))}]]}:{type:t}}};return e.__checkEvent._$aop(function(e){var n=e.args,a=t[n[1]];a&&(e.stopped=!0,e.value=a.apply(null,n))})}()}),NEJ.patch("TR>=5.0",function(){var n={propertychange:1};e.__addEvent=e.__addEvent._$aop(function(e){var t=e.args;null!=n[t[1]]&&t[0].attachEvent&&(e.stopped=!0,t[0].attachEvent("on"+t[1],t[2]))}),e.__delEvent=e.__delEvent._$aop(function(e){var t=e.args;n[t[1]];null!=n[t[1]]&&t[0].detachEvent&&(e.stopped=!0,t[0].detachEvent("on"+t[1],t[2]))})}),NEJ.patch("TR<=4.0",function(){e.__checkEvent=function(){var n={},t={input:function(e,t,a){var o={type:"propertychange"};if(a){var r=e.id,c=function(t){e.value&&!n["x-"+r]&&(n["x-"+r]=!0,a.call(e,t))};o.handler=function(t){if("value"in e&&"value"==t.propertyName){if(n[r])return;n[r]=!0,a.call(e,t),delete n[r]}},o.link=[[e,"keyup",c],[e,"mouseup",c],[e,"mousemove",c]],o.destroy=function(){delete n[r],delete n["x-"+r]}}return o},load:function(e,n,t){var a={type:"readystatechange"};return t&&(a.handler=function(n){"loaded"!=e.readyState&&"complete"!=e.readyState||t.call(e,n)}),a}};return e.__checkEvent._$aop(function(e){var n=e.args,a=t[n[1]];a&&(e.stopped=!0,e.value=a.apply(null,n)),n[2]&&(n[2]=n[2]._$bind(n[0]))})}(),e.__addEvent=function(){var e=arguments;DEBUG&&("on"+e[1]in e[0]||console.log("not support event["+e[1]+"] for "+e[0])),e[0].attachEvent("on"+e[1],e[2])},e.__delEvent=function(){var e=arguments;e[0].detachEvent("on"+e[1],e[2])},e.__dispatchEvent=function(){var e={propertychange:{propertyName:"value"}};return function(t,a,o){var r=document.createEventObject();try{n._$merge(r,e[a],o),t.fireEvent("on"+a,r)}catch(e){console.error(e.message),console.error(e.stack)}}}()}),NEJ.patch("GR",function(){e.__checkEvent=function(){var n=/^(?:transitionend|animationend|animationstart|animationiteration)$/i,t={mousewheel:function(e,n,t){var a={type:"MozMousePixelScroll"};return t&&(a.handler=function(n){var a=n.detail;n.wheelDelta=-a,n.wheelDeltaY=-a,n.wheelDeltaX=0,t.call(e,n)}),a}};return e.__checkEvent._$aop(function(e){var a=e.args;n.test(a[1])&&(e.stopped=!0,e.value={type:a[1],handler:a[2]});var o=t[a[1]];o&&(e.stopped=!0,e.value=o.apply(null,a))})}()}),e});