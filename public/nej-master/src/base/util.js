NEJ.define(["./global.js","{platform}util.js"],function(n,r,t,e,u,o){var i=function(n,r){try{return r=r.toLowerCase(),null===n?"null"==r:void 0===n?"undefined"==r:e.toString.call(n).toLowerCase()=="[object "+r+"]"}catch(n){return!1}};return t._$isFunction=function(n){return i(n,"function")},t._$isString=function(n){return i(n,"string")},t._$isNumber=function(n){return i(n,"number")},t._$isBoolean=function(n){return i(n,"boolean")},t._$isDate=function(n){return i(n,"date")},t._$isArray=function(n){return i(n,"array")},t._$isObject=function(n){return i(n,"object")},t._$length=function(){var n=/[^\x00-\xff]/g;return function(r){return(""+(r||"")).replace(n,"**").length}}(),t._$loop=function(n,e,u){return t._$isObject(n)&&t._$isFunction(e)?r.__forIn.apply(r,arguments):null},t._$indexOf=function(n,r){var e=t._$isFunction(r)?r:function(n){return n===r},u=t._$forIn(n,e);return null!=u?u:-1},t._$binSearch=function(){var n,r=function(t,e,u){if(e>u)return-1;var o=Math.ceil((e+u)/2),i=n(t[o],o,t);return 0==i?o:i<0?r(t,e,o-1):r(t,o+1,u)};return function(t,e){return n=e||u,r(t,0,t.length-1)}}(),t._$reverseEach=function(n,r,e){if(n&&n.length&&t._$isFunction(r))for(var u=n.length-1;u>=0;u--)if(r.call(e,n[u],u,n))return u;return null},t._$forEach=function(n,e,u){n&&n.length&&t._$isFunction(e)&&(n.forEach?r.__forEach(n,e,u):t._$forIn.apply(t,arguments))},t._$forIn=function(n,r,e){if(!n||!t._$isFunction(r))return null;if(t._$isNumber(n.length)){for(var u=0,o=n.length;u<o;u++)if(r.call(e,n[u],u,n))return u}else if(t._$isObject(n))return t._$loop(n,r,e);return null},t._$encode=function(n,r){return r=""+r,n&&r?r.replace(n.r,function(r){var t=n[n.i?r:r.toLowerCase()];return null!=t?t:r}):r||""},t._$escape=function(){var n=/<br\/?>$/,r={r:/\<|\>|\&|\r|\n|\s|\'|\"/g,"<":"&lt;",">":"&gt;","&":"&amp;"," ":"&nbsp;",'"':"&quot;","'":"&#39;","\n":"<br/>","\r":""};return function(e){return e=t._$encode(r,e),e.replace(n,"<br/><br/>")}}(),t._$unescape=function(){var n={r:/\&(?:lt|gt|amp|nbsp|#39|quot)\;|\<br\/\>/gi,"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" ","&#39;":"'","&quot;":'"',"<br/>":"\n"};return function(r){return t._$encode(n,r)}}(),t._$format=function(){var n={i:!0,r:/\byyyy|yy|MM|cM|eM|M|dd|d|HH|H|mm|ms|ss|m|s|w|ct|et\b/g},r=["上午","下午"],e=["A.M.","P.M."],u=["日","一","二","三","四","五","六"],o=["一","二","三","四","五","六","七","八","九","十","十一","十二"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],c=function(n){return n=parseInt(n)||0,(n<10?"0":"")+n},a=function(n){return n<12?0:1};return function(f,l,_){if(!f||!l)return"";f=t._$var2date(f),n.yyyy=f.getFullYear(),n.yy=(""+n.yyyy).substr(2),n.M=f.getMonth()+1,n.MM=c(n.M),n.eM=i[n.M-1],n.cM=o[n.M-1],n.d=f.getDate(),n.dd=c(n.d),n.H=f.getHours(),n.HH=c(n.H),n.m=f.getMinutes(),n.mm=c(n.m),n.s=f.getSeconds(),n.ss=c(n.s),n.ms=f.getMilliseconds(),n.w=u[f.getDay()];var $=a(n.H);return n.ct=r[$],n.et=e[$],_&&(n.H=n.H%12),t._$encode(n,l)}}(),t._$var2date=function(n){var e=n;return t._$isString(n)&&(e=new Date(r.__str2time(n))),t._$isDate(e)||(e=new Date(n)),e},t._$fixed=function(n,r){return parseFloat(new Number(n).toFixed(r))},t._$absolute=function(){var n=/([^\/:])\/.*$/,r=/\/[^\/]+$/,t=/[#\?]/,e=location.href.split(/[?#]/)[0],u=document.createElement("a"),o=function(n){return(n||"").indexOf("://")>0},i=function(n){return(n||"").split(t)[0].replace(r,"/")},c=function(r,t){return 0==r.indexOf("/")?t.replace(n,"$1")+r:i(t)+r};return e=i(e),function(n,r){return n=(n||"").trim(),o(r)||(r=e),n?o(n)?n:(n=c(n,r),u.href=n,n=u.href,o(n)?n:u.getAttribute("href",4)):r}}(),t._$url2origin=function(){var n=/^([\w]+?:\/\/.*?(?=\/|$))/i;return function(r){return n.test(r||"")?RegExp.$1.toLowerCase():""}}(),t._$string2object=function(n,r,e){var u={},o=e;return t._$isFunction(o)||(o=function(n){return e?decodeURIComponent(n):n}),t._$forEach((n||"").split(r),function(n){var r=n.split("=");if(r&&r.length){var t=r.shift();t&&(u[o(t)]=o(r.join("=")))}}),u},t._$object2string=function(n,r,e){if(!n)return"";var u=[],o=e;return t._$isFunction(o)||(o=function(n){return e?encodeURIComponent(n):n}),t._$loop(n,function(n,r){t._$isFunction(n)||(t._$isDate(n)?n=n.getTime():t._$isArray(n)?n=n.join(","):t._$isObject(n)&&(n=JSON.stringify(n)),u.push(o(r)+"="+o(n)))}),u.join(r||",")},t._$query2object=function(n){return t._$string2object(n,"&",!0)},t._$object2query=function(n){return t._$object2string(n,"&",!0)},t._$object2array=function(n){return r.__col2array(n)},t._$array2object=function(n,r){var e={};return t._$forEach(n,function(n){var t=n;r&&(t=r(n)),null!=t&&(e[t]=n)}),e},t._$number2string=function(n,r){var t=(""+n).length,e=Math.max(1,parseInt(r)||0),u=e-t;return u>0&&(n=new Array(u+1).join("0")+n),""+n},t._$safeDelete=function(n,r){if(t._$isArray(r))t._$forEach(r,function(r){t._$safeDelete(n,r)});else try{delete n[r]}catch(t){n[r]=void 0}},t._$randString=function(){var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";return function(r){r=r||10;for(var t,e=[],u=0;u<r;++u)t=Math.floor(Math.random()*n.length),e.push(n.charAt(t));return e.join("")}}(),t._$randNumber=function(n,r){return Math.floor(Math.random()*(r-n)+n)},t._$randNumberString=function(n){n=Math.max(0,Math.min(n||8,30));var r=Math.pow(10,n-1),e=10*r;return t._$randNumber(r,e).toString()},t._$uniqueID=function(){var n=+new Date;return function(){return""+n++}}(),t._$query=function(n,r){n=n||e;for(var t=(r||"").split("."),u=0,o=t.length;u<o&&(n=n[t[u]],n);u++);return n},t._$merge=function(){var n=arguments.length-1,r=arguments[n];t._$isFunction(r)?n-=1:r=u;for(var e=arguments[0]||{},o=1;o<=n;o++)t._$loop(arguments[o],function(n,t){r(n,t)||(e[t]=n)});return e},t._$fetch=function(n,r){return r&&t._$loop(n,function(n,t,e){var u=r[t];null!=u&&(e[t]=u)}),n},t._$hasProperty=function(n){if(!n)return!1;if(null!=n.length)return n.length>0;var r=0;return t._$loop(n,function(){return r++,r>0}),r>0},CMPT&&(n.Q=t._$query,n.X=t._$merge,n.EX=t._$fetch,n.copy(this.NEJ,n),n.copy(n.P("nej.u"),t)),t});